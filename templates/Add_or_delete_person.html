<!doctype html>
<head>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='base.css') }}" />
    <!-- icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.6.0/css/bootstrap.min.css">
    <!-- jQuery and Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.6.0/js/bootstrap.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Import bootstrap -->
</script>      
<script src=
"https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js"
integrity=
"sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx"
crossorigin="anonymous">
</script>    
<title>
    Agregar una persona
</title>
</head>
<body class="otherBodys2">
    {% if result %}
    <div id="myAlert" class="alert alert-primary" role="alert">
    <strong style="font-size: 1.25em;">{{result}}</strong><br><br>
    <a href="{{url_for('Index')}}" style="cursor: pointer;"><button type="button" class="btn btn-dark">Volver al inicio</button></a><br>
  </div>
{% endif %}
{% if resultServiceProvider %}
    <div id="AlertMio" class="alert alert-primary" role="alert">
    <strong style="font-size: 1.25em;">{{resultServiceProvider}}</strong><br><br>
    <form method="POST" action="{{url_for('AddOrDeletePerson')}}">
        <input name="RecoverServiceProviderId" value="{{check_already_exist}}" type="hidden">
        <input style="margin-right: 100px" class="btn btn-primary btn-lg" type="submit" value="SI">
    </form>
    <form method="POST" action="{{url_for('AddOrDeletePerson')}}">
        <input value="addServiceProvider" name="addServiceProvider" type="hidden">
        <input style="margin-left: 100px; margin-top: -75px;" class="btn btn-secondary btn-lg" type="submit" value="NO">
    </form>
  </div>
{% endif %}
{% if resultOwner %}
    <div id="AlertMio" class="alert alert-primary" role="alert">
    <strong style="font-size: 1.25em;">{{resultOwner}}</strong><br><br>
    <form method="POST" action="{{url_for('AddOrDeletePerson')}}">
        <input name="RecoverOwnerId" value="{{check_already_exist}}" type="hidden">
        <input style="margin-right: 100px" class="btn btn-primary btn-lg" type="submit" value="SI">
    </form>
    <form method="POST" action="{{url_for('AddOrDeletePerson')}}">
        <input value="AddOwner" name="AddOwner" type="hidden">
        <input style="margin-left: 100px; margin-top: -75px;" class="btn btn-secondary btn-lg" type="submit" value="NO">
    </form>
  </div>
{% endif %}
{% if resultAddOwner %}
    <div id="AlertMio" class="alert alert-primary" role="alert">
    <strong style="font-size: 1.25em;">{{resultAddOwner2}}</strong><br><br>
    <form method="POST" action="{{url_for('AddOrDeletePerson')}}">
        <input name="updatePersonRecoverByDniOwner" value="{{dni}}" type="hidden">
        <input style="margin-right: 100px" class="btn btn-primary btn-lg" type="submit" value="SI">
    </form>
    <form method="POST" action="{{url_for('AddOrDeletePerson')}}">
        <input value="AddOwner" name="AddOwner" type="hidden">
        <input style="margin-left: 100px; margin-top: -75px;" class="btn btn-secondary btn-lg" type="submit" value="NO">
    </form>
  </div>
{% endif %}
{% if resultAddServiceProvicer %}
    <div id="AlertMio" class="alert alert-primary" role="alert">
    <strong style="font-size: 1.25em;">{{resultAddServiceProvicer}}</strong><br><br>
    <form method="POST" action="{{url_for('AddOrDeletePerson')}}">
        <input name="updatePersonRecoverByDniServiceProvider" value="{{dni}}" type="hidden">
        <input style="margin-right: 100px" class="btn btn-primary btn-lg" type="submit" value="SI">
    </form>
    <form method="POST" action="{{url_for('AddOrDeletePerson')}}">
        <input value="addServiceProvider" name="addServiceProvider" type="hidden">
        <input style="margin-left: 100px; margin-top: -75px;" class="btn btn-secondary btn-lg" type="submit" value="NO">
    </form>
  </div>
{% endif %}
{% if resultAddTenant %}
    <div id="AlertMio" class="alert alert-primary" role="alert">
    <strong style="font-size: 1.25em;">{{resultAddTenant}}</strong><br><br>
    <form method="POST" action="{{url_for('AddOrDeletePerson')}}">
        <input name="updatePersonRecoverByDniTenant" value="{{dni}}" type="hidden">
        <input style="margin-right: 100px" class="btn btn-primary btn-lg" type="submit" value="SI">
    </form>
    <form method="POST" action="{{url_for('AddOrDeletePerson')}}">
        <input value="addTenant" name="addTenant" type="hidden">
        <input style="margin-left: 100px; margin-top: -75px;" class="btn btn-secondary btn-lg" type="submit" value="NO">
    </form>
  </div>
{% endif %}

{% if all_people_tenants %}
<input class="form-control" id="myInput" type="text" placeholder="Buscar..">
<br>
<div id=tableHead class="alert alert-info">ELIGE UNA PERSONA O AGREGA UNA NUEVA
    <button id="AddTask" type="button" class="btn btn-secondary btn-lg" data-toggle="modal" data-target="#AddPersonTenant">AGREGAR PERSONA</button>
</div>
<table class="table table-light" style="align-items: center; text-align: center">
  <thead class="table-dark">
    <tr class="ver">
      <th scope="col"> NOMBRE Y APPELLIDO </th>
      <th scope="col"> DNI </th>
      <th scope="col"> SELECCIONAR </th>
  </tr>
</thead>
{% for person in all_people_tenants %}
<tbody id="myTable">
<tr>
  <th scope="row"> {{ person.name }} {{ person.surname }} </th>
  <th scope="row"> {{ person.dni }} </th>
  <th scope="row"><button data-id="{{person}}" id="{{person.id_person}}" type="button" class="btn allbuttons btn-success" data-toggle="modal" data-target="#ModalTenant">Seleccionar</button></th>
</tbody>
{% endfor %}

{% endif %}
</table>
{% if all_people_tenants == [] %}
<input class="form-control" id="myInput" type="text" placeholder="Buscar..">
<br>
<div id=tableHead class="alert alert-info">ELIGE UNA PERSONA O AGREGA UNA NUEVA
    <button id="AddTask" type="button" class="btn btn-secondary btn-lg" data-toggle="modal" data-target="#AddPersonTenant">AGREGAR PERSONA</button>
</div>
<table class="table table-light" style="align-items: center; text-align: center">
  <thead class="table-dark">
    <tr class="ver">
      <th scope="col"> NOMBRE Y APPELLIDO </th>
      <th scope="col"> DNI </th>
      <th scope="col"> SELECCIONAR </th>
  </tr>
</thead>
</table>
<div id=tableHead class="alert alert-success"> Aun no has agregado ninguna persona</div>
{% endif %}

{% if all_people_owners %}
<input class="form-control" id="myInput" type="text" placeholder="Buscar..">
<br>
<div id=tableHead class="alert alert-info">ELIGE UNA PERSONA O AGREGA UNA NUEVA
    <button id="AddTask" type="button" class="btn btn-secondary btn-lg" data-toggle="modal" data-target="#AddPersonOwner">AGREGAR PERSONA</button>
</div>
<table class="table table-light" style="align-items: center; text-align: center">
  <thead class="table-dark">
    <tr class="ver">
      <th scope="col"> NOMBRE Y APPELLIDO </th>
      <th scope="col"> DNI </th>
      <th scope="col"> SELECCIONAR </th>
  </tr>
</thead>
{% for person in all_people_owners %}
<tbody id="myTable">
<tr>
  <th scope="row"> {{ person.name }} {{ person.surname }} </th>
  <th scope="row"> {{ person.dni }} </th>
  <th scope="row"><button data-id="{{person}}" id="{{person.id_person}}" type="button" class="btn allbuttons btn-success" data-toggle="modal" data-target="#ModalOwner">Seleccionar</button></th>
</tbody>
{% endfor %}
{% endif %}
</table>
{% if all_people_owners == [] %}
<input class="form-control" id="myInput" type="text" placeholder="Buscar..">
<br>
<div id=tableHead class="alert alert-info">ELIGE UNA PERSONA O AGREGA UNA NUEVA
    <button id="AddTask" type="button" class="btn btn-secondary btn-lg" data-toggle="modal" data-target="#AddPersonOwner">AGREGAR PERSONA</button>
</div>
<table class="table table-light" style="align-items: center; text-align: center">
  <thead class="table-dark">
    <tr class="ver">
      <th scope="col"> NOMBRE Y APPELLIDO </th>
      <th scope="col"> DNI </th>
      <th scope="col"> SELECCIONAR </th>
  </tr>
</thead>
</table>
<div id=tableHead class="alert alert-success"> Aun no has agregado ninguna persona</div>
{% endif %}


{% if all_people_service_providers %}
<input class="form-control" id="myInput" type="text" placeholder="Buscar..">
<br>
<div id=tableHead class="alert alert-info">ELIGE UNA PERSONA O AGREGA UNA NUEVA
    <button id="AddTask" type="button" class="btn btn-secondary btn-lg" data-toggle="modal" data-target="#AddPersonServiceProvider">AGREGAR PERSONA</button>
</div>
<table class="table table-light" style="align-items: center; text-align: center">
  <thead class="table-dark">
    <tr class="ver">
      <th scope="col"> NOMBRE Y APPELLIDO </th>
      <th scope="col"> DNI </th>
      <th scope="col"> SELECCIONAR </th>
  </tr>
</thead>
{% for person in all_people_service_providers %}
<tbody id="myTable">
<tr>
  <th scope="row"> {{ person.name }} {{ person.surname }} </th>
  <th scope="row"> {{ person.dni }} </th>
  <th scope="row"><button data-id="{{person}}" id="{{person.id_person}}" type="button" class="btn allbuttons btn-success" data-toggle="modal" data-target="#ModalServiceProvider">Seleccionar</button></th>
</tbody>
{% endfor %}

{% endif %}
</table>
{% if all_people_service_providers == [] %}
<input class="form-control" id="myInput" type="text" placeholder="Buscar..">
<br>
<div id=tableHead class="alert alert-info">ELIGE UNA PERSONA O AGREGA UNA NUEVA
    <button id="AddTask" type="button" class="btn btn-secondary btn-lg" data-toggle="modal" data-target="#AddPersonServiceProvider">AGREGAR PERSONA</button>
</div>
<table class="table table-light" style="align-items: center; text-align: center">
  <thead class="table-dark">
    <tr class="ver">
      <th scope="col"> NOMBRE Y APPELLIDO </th>
      <th scope="col"> DNI </th>
      <th scope="col"> SELECCIONAR </th>
  </tr>
</thead>
</table>

<div id=tableHead class="alert alert-success"> Aun no has agregado ninguna persona</div>
{% endif %} 


<!-- MODAL FOR ADDING A PERSON IN PERSON TABLE (OWNER)-->
<div class="modal fade bd-example-modal-lg" id="AddPersonTenant" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">INGRESA NUEVA PERSONA</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
      </button>
  </div>
  <div class="modal-body">
    <div class="container-fluid">
      <div class="row">
        <div class="col" style="text-align: center;">
          <form method="POST" action="{{url_for('AddOrDeletePerson')}}">
            <input value="AddPersonTenant" name="AddPersonTenant" type="hidden">
            <li>Nombre</li>
            <li><input id="name" name="name" placeholder="Nombre" required></li>
            <li>Apellido</li>
            <li><input id="surname" name="surname" placeholder="Apellido" required></li>
            <li>Telefono</li>
            <li><input id="cellphone" name="cellphone" placeholder="Telefono"></input></li>
            <li>Mail</li>
            <li><input id="mail" name="mail" placeholder="Mail"></input></li>
            <li>Direccion</li>
            <li><input id="address" name="address" placeholder="Direccion"></input></li>
            <li>DNI</li>
            <li><input id="dni" name="dni" placeholder="DNI" required></input></li>
        </div>
        <div class="modal-footer">
          <input style="margin-right: 530px; margin-top: 20px;" class="btn btn-primary" type="submit" id="send-signup" name="signup" value="Agregar"/>
          </form>
          <button style="margin-right: 40px; margin-top: 20px" type="button" class="btn btn-secondary" data-dismiss="modal">Cerrar</button>
        </div>
       </div>
      </div>
    </div>
  </div>
 </div>
</div>

<!-- MODAL FOR ADDING A PERSON IN PERSON TABLE (OWNER)-->
<div class="modal fade bd-example-modal-lg" id="AddPersonOwner" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">INGRESA NUEVA PERSONA</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
      </button>
  </div>
  <div class="modal-body">
    <div class="container-fluid">
      <div class="row">
        <div class="col" style="text-align: center;">
          <form method="POST" action="{{url_for('AddOrDeletePerson')}}">
            <input value="AddPersonOwner" name="AddPersonOwner" type="hidden">
            <li>Nombre</li>
            <li><input id="name" name="name" placeholder="Nombre" required></li>
            <li>Apellido</li>
            <li><input id="surname" name="surname" placeholder="Apellido" required></li>
            <li>Telefono</li>
            <li><input id="cellphone" name="cellphone" placeholder="Telefono"></input></li>
            <li>Mail</li>
            <li><input id="mail" name="mail" placeholder="Mail"></input></li>
            <li>Direccion</li>
            <li><input id="address" name="address" placeholder="Direccion"></input></li>
            <li>DNI</li>
            <li><input id="dni" name="dni" placeholder="DNI" required></input></li>
        </div>
        <div class="modal-footer">
          <input style="margin-right: 530px; margin-top: 20px;" class="btn btn-primary" type="submit" id="send-signup" name="signup" value="Agregar"/>
          </form>
          <button style="margin-right: 40px; margin-top: 20px" type="button" class="btn btn-secondary" data-dismiss="modal">Cerrar</button>
        </div>
       </div>
      </div>
    </div>
  </div>
 </div>
</div>

<!-- MODAL FOR ADDING A PERSON IN PERSON TABLE (SERVICE PROVIDER) -->
<div class="modal fade bd-example-modal-lg" id="AddPersonServiceProvider" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">INGRESA NUEVA PERSONA</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
      </button>
  </div>
  <div class="modal-body">
    <div class="container-fluid">
      <div class="row">
        <div class="col" style="text-align: center;">
          <form method="POST" action="{{url_for('AddOrDeletePerson')}}">
            <input value="AddPersonServiceProvider" name="AddPersonServiceProvider" type="hidden">
            <li>Nombre</li>
            <li><input id="name" name="name" placeholder="Nombre" required></li>
            <li>Apellido</li>
            <li><input id="surname" name="surname" placeholder="Apellido" required></li>
            <li>Telefono</li>
            <li><input id="cellphone" name="cellphone" placeholder="Telefono"></input></li>
            <li>Mail</li>
            <li><input id="mail" name="mail" placeholder="Mail"></input></li>
            <li>Direccion</li>
            <li><input id="address" name="address" placeholder="Direccion"></input></li>
            <li>DNI</li>
            <li><input id="dni" name="dni" placeholder="DNI" required></input></li>
        </div>
        <div class="modal-footer">
          <input style="margin-right: 530px; margin-top: 20px;" class="btn btn-primary" type="submit" id="send-signup" name="signup" value="Agregar"/>
          </form>
          <button style="margin-right: 40px; margin-top: 20px" type="button" class="btn btn-secondary" data-dismiss="modal">Cerrar</button>
        </div>
       </div>
      </div>
    </div>
  </div>
 </div>
</div>

<!-- Modal for service providers -->
<div class="modal fade" id="ModalServiceProvider" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-body">
        {% if all_services == [] %}
        <h5 style="color: black;">No hay servicios disponibles</h5>
        <div class="modal-footer">
        <a href="{{url_for('Add_Service')}}"><button type="button" class="btn btn-primary">Agregar servicio</button></a>
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Cerrar</button>
      </div>
        {% else %}
              <div class="modal-header">
        <h5 class="modal-title" id="staticBackdropLabel">Elegi un servicio</h5>
        <a href="{{url_for('Add_Service')}}"><button type="button" class="btn btn-primary">Agregar servicio</button></a>
      </div><br>
        <form method="POST" action="{{url_for('AddOrDeletePerson')}}">
          <p>Que servicio prestara <p id="name_and_surname"></p>
        <select class="select" style="height:45px" name="IdServiceIsServiceProvider" required>
          {% for service in all_services %}
          {% if service.still_exist == 1 %}
          <option name="id_service" value="{{service.id_service}}">{{service.service_name}}</option>
          {% endif %}
          {% endfor %}
        </select>
                <input style="text-align:center;" name="registration_number" placeholder="Matricula">
      </div>
      <div class="modal-footer">
        <input id="IdPersonIsServiceProvider" name="IdPersonIsServiceProvider" value="{{IdPersonIsServiceProvider}}" type="hidden">
        <input class="btn btn-primary" type="submit" value="Aceptar"/>
        </form>
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Cerrar</button>
      </div>
   </div>
  </div>
 </div>
{% endif %}

<!-- Modal for tenants -->
<div class="modal fade" id="ModalTenant" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-body">
        {% if available_propertys_tenants == [] %}
        <h5 style="color: black;">No hay propiedades disponibles</h5>
        <div class="modal-footer">
        <a href="{{url_for('Add_property')}}"><button type="button" class="btn btn-primary">Agregar propiedad</button></a>
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Cerrar</button>
      </div>
        {% else %}
              <div class="modal-header">
        <h5 class="modal-title" id="staticBackdropLabel">Elegi una propiedad</h5>
        <a href="{{url_for('Add_property')}}"><button type="button" class="btn btn-primary">Agregar propiedad</button></a>
      </div><br>
        <p>En que propiedad alquilara <p id="name_and_surname"></p>
        <form method="POST" action="{{url_for('AddOrDeletePerson')}}">
        <select class="select" style="height:45px" name="IdPropertyTenant" required>
          {% for property in available_propertys_tenants %}
          {% if property.already_exist == 1 %}
          <option name="id_property" value="{{property.id_property}}">{{property.street}} {{property.number}}, {{property.state}} --> Nomenclarutra: {{property.nomenclatura}}</option>
          {% endif %}
          {% endfor %}
        </select>
        </select>
      </div>
      <div class="modal-footer">
        <input id="IdPersonTenant" name="IdPersonTenant" value="{{IdPersonTenant}}" type="hidden">
        <input class="btn btn-primary" type="submit" value="Aceptar"/>
        </form>
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Cerrar</button>
      </div>
   </div>
  </div>
 </div>
{% endif %}

<!-- Modal for Owners -->
<div class="modal fade" id="ModalOwner" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      {% if all_propertys == [] %}
        <h5 style="margin-top: 15px; margin-left: 15px" class="modal-title" id="staticBackdropLabel">No hay propiedades disponibles</h5>
        <div class="modal-footer">
        <a href="{{url_for('Add_property')}}"><button type="button" class="btn btn-primary">Agregar propiedad</button></a>
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Cerrar</button>
      </div>
        {% else %}
      <div class="modal-header">
        <h5 class="modal-title" id="staticBackdropLabel">Elegi una propiedad</h5>
        <a href="{{url_for('Add_property')}}"><button type="button" class="btn btn-primary">Agregar propiedad</button></a>
      </div>
      <div class="modal-body">
        <p>A que propiedad asociaras a <p id="name_and_surname"></p>
        <form method="POST" action="{{url_for('AddOrDeletePerson')}}">
        <select class="select" style="height:45px" name="IdPropertyOwner" required>
          {% for property in all_propertys %}
          {% if property.already_exist == 1 %}
          <option name="id_property" value="{{property.id_property}}">{{property.street}} {{property.number}}, {{property.state}} --> Nomenclarutra: {{property.nomenclatura}}</option>
          {% endif %}
          {% endfor %}
        </select>
              <div class="modal-footer">
        <input id="IdPersonOwner" name="IdPersonOwner" value="{{IdPersonOwner}}" type="hidden">
        <input class="btn btn-primary" type="submit" value="Aceptar"/>
        </form>
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Cerrar</button>
      </div>
      </div>
   </div>
  </div>
 </div>
        {% endif %}
      



<script type="text/javascript">       
  $(".allbuttons").click(function () {
    var id = $(this).attr('id');
    var requiredData = document.getElementById(id).getAttribute("data-id")
    var tenant = requiredData.replace(/'/g,'"')
    var object = JSON.parse(tenant)
    nameAndSurname = object.name + " " + object.surname
    $("#ModalServiceProvider #name_and_surname").html(nameAndSurname)
    $("#ModalServiceProvider #IdPersonIsServiceProvider").val(object.id_person)
    $("#ModalOwner #name_and_surname").html(nameAndSurname)
    $("#ModalOwner #IdPersonOwner").val(object.id_person)
    $("#ModalTenant #IdPersonTenant").val(object.id_person)
    $("#ModalTenant #name_and_surname").html(nameAndSurname)
});

  $(document).ready(function(){
    $("#myInput").on("keyup", function() {
      var value = $(this).val().toLowerCase();
      $("#myTable tr").filter(function() {
        $(this).toggle($(this).text().toLowerCase().indexOf(value) > -1)
      });
    });
  });

  $(document).ready(function() {
    $('#myAlert').fadeIn();
    setTimeout(function() {
      $('#myAlert').fadeOut();
    }, 5000); // 5 seconds
  });
</script>
</body>